<!-- dashboard.ejs -->
<link rel="stylesheet" href="/dashboard.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

<%- include('partials/header') %>

<div class="container">
  <div class="dashboard-container">
    <h2 class="welcome-text">Welcome, <%= user.username %>!</h2>
    <div class="dashboard-actions">
      <button class="btn" id="showUploadBtn">
        <i class="fas fa-upload"></i> Upload New File
      </button>
      <a href="/logout" class="logout-link">
        <i class="fas fa-sign-out-alt"></i> Logout
      </a>
    </div>
  </div>
  
  <div class="upload-section" id="uploadSection" style="display: none;">
    <%- include('partials/upload') -%>
  </div>
  
  <div class="uploaded-files">
    <h3>Your Files</h3>

    <% if (message) { %>
      <div class="alert-success">
        <%= message %>
      </div>
    <% } %>
    
    <% if (files.length === 0) { %>
      <div class="empty-state">
        <i class="fas fa-folder-open fa-3x"></i>
        <p>You haven't uploaded any files yet. Use the upload button to get started!</p>
      </div>
    <% } else { %>
      <div class="files-grid">
        <% files.forEach(file => { %>
          <div class="file-card">
            <div class="file-header">
              <h4><%= file.name %></h4>
              <span class="file-type"><%= file.fileType %></span>
            </div>
            <div class="file-body">
              <div class="file-actions">

                <a href="/dashboard/file/<%= encodeURIComponent(file.id) %>" class="btn">
                  <i class="fas fa-info-circle"></i> Details
                </a>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </div>
</div>

<script>
    document.getElementById('showUploadBtn').addEventListener('click', function() {
      const uploadSection = document.getElementById('uploadSection');
      if (uploadSection.style.display === 'none') {
        uploadSection.style.display = 'block'; 
      } else {
        uploadSection.style.display = 'none'; 
      }
    });
  </script>